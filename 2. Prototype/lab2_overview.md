### Обзор учебного микросервиса
# Лабораторная работа N 2
### Задание к выполнению лабораторной работы.

В качестве первой работы с кодом Geo-сервиса предлагается расширить его функциональность возможностью собирать детальную информацию о городах.
Под детальной информацией в контексте этой лабораторной работы понимается список музеев и отелей в городе.

В протоколе уже есть флаг `include_details`, влияющий на то, будет ли ответ содержать детальную информацию.  
Поэтому протокол трогать не нужно.

В диагностическом режиме (запуск с ключом `--debug`), флаг `include_details` по умолчанию включен (см. [DebugHelpers.cc](https://github.com/cqginternship/geo-service/blob/master/src/DebugHelpers.cc)).

### Требования к результату

Результатом выполнения запроса `GetCities()` с установленным флагом `include_details` должны быть города, описанные сообщениями `Place`, и у каждого такого сообщения должна быть заполнена коллекция `features`.

В каждом элементе коллекции `features` поле `tags` должно содержать три элемента типа ключ-значение:

1. Ключ `tourism`, значение — `museum` или `hotel`.
2. Ключ `name`, значение — наименование объекта на "родном" языке.
3. Ключ `name:en`, значение — наименование объекта на английском языке.

Поддержка детальной информации должны быть доступна независимо от того, какой способ поиска выбран: по имени города или по его координатам.

Аналогично, при запуске в диагностическом режиме, программа так же должна формировать список городов с детальной информации, см. пример ниже.

### Пример

Обратите внимание, что на данном этапе в программе есть ряд багов.  
Исправлять их в рамках текущей лабораторной работы не нужно, этому будет посвящена лабораторная работа №2.

Тем не менее, имеющиеся баги не должны мешать добавить поддержку детальной информации.

Пример запуска в диагностическом режиме:
```
$ ./build/geo --debug --config ./geo-config.json --lat 38.0152172 --lon 12.5062563
```

Ожидаемый результат:
```
I0808 15:49:32.130848  272230 DebugHelpers.cc:25] Found place Trapani (), country Italia (), (38.0173961,12.5160225)
I0808 15:49:32.130871  272230 DebugHelpers.cc:30]    [hotel] Hotel Punta Tipa () (38.0293816,12.5279839)
I0808 15:49:32.130879  272230 DebugHelpers.cc:30]    [hotel] Hotel Vittoria () (38.0194069,12.5176408)
I0808 15:49:32.130886  272230 DebugHelpers.cc:30]    [hotel] Hotel Moderno () (38.0162475,12.5091478)
I0808 15:49:32.130892  272230 DebugHelpers.cc:30]    [hotel] Messina () (38.0157591,12.5069981)
I0808 15:49:32.130898  272230 DebugHelpers.cc:30]    [museum] Museo G. Perricone () (38.0150078,12.5065643)
I0808 15:49:32.130904  272230 DebugHelpers.cc:30]    [hotel] Gafada () (38.0176209,12.5133617)
I0808 15:49:32.130910  272230 DebugHelpers.cc:30]    [hotel] Ciuri Home () (38.0146784,12.5182342)
I0808 15:49:32.130916  272230 DebugHelpers.cc:30]    [hotel] Crystal Hotel () (38.0177472,12.5191967)
I0808 15:49:32.130922  272230 DebugHelpers.cc:30]    [hotel] Albergo Maccotta () (38.0151632,12.509799)
I0808 15:49:32.130929  272230 DebugHelpers.cc:30]    [museum] Typographiae Museo della Stampa () (38.0176222,12.5121525)
I0808 15:49:32.130935  272230 DebugHelpers.cc:30]    [museum] La Salerniana Museo d'Arte Contemporanea (La Salerniana, museum of contemporary art) (38.0152172,12.5062563)
I0808 15:49:32.130942  272230 DebugHelpers.cc:30]    [hotel] Palazzo Gatto Art Hotel & Spa () (38.0156194,12.5099266)
I0808 15:49:32.130948  272230 DebugHelpers.cc:30]    [hotel] Appartamenti Fardella 250 () (38.019723,12.5271485)
I0808 15:49:32.130954  272230 DebugHelpers.cc:30]    [museum] Museum of Optical Illusions () (38.0162292,12.5130794)
I0808 15:49:32.130960  272230 DebugHelpers.cc:30]    [hotel] Re Sale Hotel () (38.0152881,12.5124886)
I0808 15:49:32.130966  272230 DebugHelpers.cc:30]    [hotel] Ai Lumi B&B () (38.0157424,12.5070669)
```

### Советы по реализации

В [SearchEngine.cc](https://github.com/cqginternship/geo-service/blob/master/src/search/SearchEngine.cc) есть TODO в том месте, где нужно реализовать поддержку детальной информации.

Вся необходимая информация доступна через **Overpass API**.  
В качестве отправной точки у вас будут **Relation Id** для городов.
Для каждого **Relation** нужно собрать все такие **Node**, у которых присутствует тег `tourism` в значении `hotel` или `museum`.  
Для подсказки о том, как формировать **Overpass QL** запрос, смотрите в лекцию.

Если для какого-то объекта Overpass не предоставляет имя на "родном" или на английском языке, добавлять ключ с пустым значением в `tags` не нужно.
